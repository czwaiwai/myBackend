<% layout('./layout/layout') %>
<% block('header').append(`<style></style>`)%>
<div class="row">
  <div class="col-md-12">
    <div class="box box-info">
      <div class="box-header with-border">
        <h3 class="box-title"><%=curr.isNew?'添加':'修改'%>单页</h3>
      </div>
      <!-- /.box-header -->
      <!-- form start -->
      <form action="<%=assetsPath %>/postage/add" method="post" class="form-horizontal" novalidate>
        <div class="box-body">
          <div class="form-group">
            <label for="title" class="col-sm-2 control-label">省份</label>
            <div class="col-sm-10">
              <select id="province" class="form-control" ></select>
            </div>
          </div>
          <div class="form-group">
            <label for="path" class="col-sm-2 control-label">城市</label>
            <div class="col-sm-10">
              <select id="city" class="form-control"  >
                <option value="">请选择</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="path" class="col-sm-2 control-label">邮费</label>
            <div class="col-sm-10">
              <input name="fee" class="form-control"  >
            </div>
          </div>
          <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10">
              <div class="checkbox">
                <label>
                  <input name="isValid" value="1" type="checkbox"> 是否有效
                </label>
              </div>
            </div>
          </div>
        </div>
        <!-- /.box-body -->
        <div class="box-footer">
          <div class="col-sm-offset-2 col-sm-10">
            <% if(!curr.isNew) { %>
            <input name="_id" type="hidden" value="<%=curr._id%>" >
            <% }%>
            <button type="submit" class="btn btn-info ">保存</button>
            <button type="reset" class="btn btn-default">重置</button>
          </div>
        </div>
        <!-- /.box-footer -->
      </form>
    </div>
  </div>
</div>
<% block('footer').append(`<script>
    jQuery(function() {
    	var $province =  $('#province')
    	var $city = $('#city')
        $.get('/cityAndArea').done(function (res) {
        	console.log(res)
        	var tmp = '<option value="">请选择</option>'
        	res.data.list.forEach(function(item){
        		tmp += '<option value="' + item.id + ',' + item.name+'" >'+ item.name +'</option>'
        	})
            $province.append(tmp)
        })
        $province.on('change', function () {
        	var $this = $(this)
        	var val = $this.val()
        	var arr = val.split(',')
        	$.get('/cityAndArea?addrId=' + arr[0] + '&name=city').done(function(res){
        	  var tmp = '<option value="">请选择</option>'
              res.data.list.forEach(function(item){
                tmp += '<option value="' + item.id + ',' + item.name+'" >'+ item.name +'</option>'
                $city.empty().append(tmp)
              })
        	})
        })
    })
</script>`)%>